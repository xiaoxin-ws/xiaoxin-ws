import{j as Z}from"./jsbn-dWep3C2S.js";const{BigInteger:T}=Z;function vt(e){let t=e.toString(16);if(t[0]!=="-")t.length%2===1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t);else{t=t.substr(1);let n=t.length;n%2===1?n+=1:t.match(/^[0-7]/)||(n+=2);let r="";for(let i=0;i<n;i++)r+="f";r=new T(r,16),t=r.xor(e).add(T.ONE),t=t.toString(16).replace(/^-/,"")}return t}class nt{constructor(){this.tlv=null,this.t="00",this.l="00",this.v=""}getEncodedHex(){return this.tlv||(this.v=this.getValue(),this.l=this.getLength(),this.tlv=this.t+this.l+this.v),this.tlv}getLength(){const t=this.v.length/2;let n=t.toString(16);return n.length%2===1&&(n="0"+n),t<128?n:(128+n.length/2).toString(16)+n}getValue(){return""}}class rt extends nt{constructor(t){super(),this.t="02",t&&(this.v=vt(t))}getValue(){return this.v}}class It extends nt{constructor(t){super(),this.t="30",this.asn1Array=t}getValue(){return this.v=this.asn1Array.map(t=>t.getEncodedHex()).join(""),this.v}}function it(e,t){return+e[t+2]<8?1:+e.substr(t+2,2)&128}function st(e,t){const n=it(e,t),r=e.substr(t+2,n*2);return r?(+r[0]<8?new T(r,16):new T(r.substr(2),16)).intValue():-1}function J(e,t){const n=it(e,t);return t+(n+1)*2}var bt={encodeDer(e,t){const n=new rt(e),r=new rt(t);return new It([n,r]).getEncodedHex()},decodeDer(e){const t=J(e,0),n=J(e,t),r=st(e,t),i=e.substr(n,r*2),s=n+i.length,u=J(e,s),f=st(e,s),o=e.substr(u,f*2),F=new T(i,16),l=new T(o,16);return{r:F,s:l}}};const{BigInteger:x}=Z,ot=new x("2"),ut=new x("3");class C{constructor(t,n){this.x=n,this.q=t}equals(t){return t===this?!0:this.q.equals(t.q)&&this.x.equals(t.x)}toBigInteger(){return this.x}negate(){return new C(this.q,this.x.negate().mod(this.q))}add(t){return new C(this.q,this.x.add(t.toBigInteger()).mod(this.q))}subtract(t){return new C(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))}multiply(t){return new C(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))}divide(t){return new C(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))}square(){return new C(this.q,this.x.square().mod(this.q))}}class H{constructor(t,n,r,i){this.curve=t,this.x=n,this.y=r,this.z=i??x.ONE,this.zinv=null}getX(){return this.zinv===null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}getY(){return this.zinv===null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}equals(t){return t===this?!0:this.isInfinity()?t.isInfinity():t.isInfinity()?this.isInfinity():t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(x.ZERO)?t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(x.ZERO):!1}isInfinity(){return this.x===null&&this.y===null?!0:this.z.equals(x.ZERO)&&!this.y.toBigInteger().equals(x.ZERO)}negate(){return new H(this.curve,this.x,this.y.negate(),this.z)}add(t){if(this.isInfinity())return t;if(t.isInfinity())return this;const n=this.x.toBigInteger(),r=this.y.toBigInteger(),i=this.z,s=t.x.toBigInteger(),u=t.y.toBigInteger(),f=t.z,o=this.curve.q,F=n.multiply(f).mod(o),l=s.multiply(i).mod(o),c=F.subtract(l),a=r.multiply(f).mod(o),y=u.multiply(i).mod(o),g=a.subtract(y);if(x.ZERO.equals(c))return x.ZERO.equals(g)?this.twice():this.curve.infinity;const p=F.add(l),m=i.multiply(f).mod(o),q=c.square().mod(o),B=c.multiply(q).mod(o),P=m.multiply(g.square()).subtract(p.multiply(q)).mod(o),S=c.multiply(P).mod(o),k=g.multiply(q.multiply(F).subtract(P)).subtract(a.multiply(B)).mod(o),j=B.multiply(m).mod(o);return new H(this.curve,this.curve.fromBigInteger(S),this.curve.fromBigInteger(k),j)}twice(){if(this.isInfinity())return this;if(!this.y.toBigInteger().signum())return this.curve.infinity;const t=this.x.toBigInteger(),n=this.y.toBigInteger(),r=this.z,i=this.curve.q,s=this.curve.a.toBigInteger(),u=t.square().multiply(ut).add(s.multiply(r.square())).mod(i),f=n.shiftLeft(1).multiply(r).mod(i),o=n.square().mod(i),F=o.multiply(t).multiply(r).mod(i),l=f.square().mod(i),c=u.square().subtract(F.shiftLeft(3)).mod(i),a=f.multiply(c).mod(i),y=u.multiply(F.shiftLeft(2).subtract(c)).subtract(l.shiftLeft(1).multiply(o)).mod(i),g=f.multiply(l).mod(i);return new H(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(y),g)}multiply(t){if(this.isInfinity())return this;if(!t.signum())return this.curve.infinity;const n=t.multiply(ut),r=this.negate();let i=this;for(let s=n.bitLength()-2;s>0;s--){i=i.twice();const u=n.testBit(s),f=t.testBit(s);u!==f&&(i=i.add(u?this:r))}return i}}let Bt=class{constructor(e,t,n){this.q=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(n),this.infinity=new H(this,null,null)}equals(e){return e===this?!0:this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)}fromBigInteger(e){return new C(this.q,e)}decodePointHex(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:const t=this.fromBigInteger(new x(e.substr(2),16));let n=this.fromBigInteger(t.multiply(t.square()).add(t.multiply(this.a)).add(this.b).toBigInteger().modPow(this.q.divide(new x("4")).add(x.ONE),this.q));return n.toBigInteger().mod(ot).equals(new x(e.substr(0,2),16).subtract(ot))||(n=n.negate()),new H(this,t,n);case 4:case 6:case 7:const r=(e.length-2)/2,i=e.substr(2,r),s=e.substr(r+2,r);return new H(this,this.fromBigInteger(new x(i,16)),this.fromBigInteger(new x(s,16)));default:return null}}};var qt={ECPointFp:H,ECCurveFp:Bt};const{BigInteger:I,SecureRandom:Pt}=Z,{ECCurveFp:Et}=qt,At=new Pt,{curve:z,G:Ct,n:lt}=ct();function Ht(){return z}function ct(){const e=new I("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF",16),t=new I("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC",16),n=new I("28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93",16),r=new Et(e,t,n),i=r.decodePointHex("0432C4AE2C1F1981195F9904466A39C9948FE30BBFF2660BE1715A4589334C74C7BC3736A2F4F6779C59BDCEE36B692153D0A9877CC62A474002DF32E52139F0A0"),s=new I("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123",16);return{curve:r,G:i,n:s}}function St(e,t,n){const r=(e?new I(e,t,n):new I(lt.bitLength(),At)).mod(lt.subtract(I.ONE)).add(I.ONE),i=L(r.toString(16),64),s=Ct.multiply(r),u=L(s.getX().toBigInteger().toString(16),64),f=L(s.getY().toBigInteger().toString(16),64),o="04"+u+f;return{privateKey:i,publicKey:o}}function Kt(e){if(e.length!==130)throw new Error("Invalid public key to compress");const t=(e.length-2)/2,n=e.substr(2,t),r=new I(e.substr(t+2,t),16);let i="03";return r.mod(new I("2")).equals(I.ZERO)&&(i="02"),i+n}function Rt(e){e=unescape(encodeURIComponent(e));const t=e.length,n=[];for(let i=0;i<t;i++)n[i>>>2]|=(e.charCodeAt(i)&255)<<24-i%4*8;const r=[];for(let i=0;i<t;i++){const s=n[i>>>2]>>>24-i%4*8&255;r.push((s>>>4).toString(16)),r.push((s&15).toString(16))}return r.join("")}function L(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e}function Tt(e){return e.map(t=>(t=t.toString(16),t.length===1?"0"+t:t)).join("")}function zt(e){const t=[];let n=0;for(let r=0;r<e.length*2;r+=2)t[r>>>3]|=parseInt(e[n],10)<<24-r%8*4,n++;try{const r=[];for(let i=0;i<e.length;i++){const s=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(s))}return decodeURIComponent(escape(r.join("")))}catch{throw new Error("Malformed UTF-8 data")}}function Dt(e){const t=[];let n=e.length;n%2!==0&&(e=L(e,n+1)),n=e.length;for(let r=0;r<n;r+=2)t.push(parseInt(e.substr(r,2),16));return t}function Ot(e){const t=z.decodePointHex(e);if(!t)return!1;const n=t.getX();return t.getY().square().equals(n.multiply(n.square()).add(n.multiply(z.a)).add(z.b))}function Ut(e,t){const n=z.decodePointHex(e);if(!n)return!1;const r=z.decodePointHex(t);return r?n.equals(r):!1}var kt={getGlobalCurve:Ht,generateEcparam:ct,generateKeyPairHex:St,compressPublicKeyHex:Kt,utf8ToHex:Rt,leftPad:L,arrayToHex:Tt,arrayToUtf8:zt,hexToArray:Dt,verifyPublicKey:Ot,comparePublicKeyHex:Ut};const b=new Uint32Array(68),Q=new Uint32Array(64);function v(e,t){const n=t&31;return e<<n|e>>>32-n}function ht(e,t){const n=[];for(let r=e.length-1;r>=0;r--)n[r]=(e[r]^t[r])&255;return n}function jt(e){return e^v(e,9)^v(e,17)}function Lt(e){return e^v(e,15)^v(e,23)}function Y(e){let t=e.length*8,n=t%512;n=n>=448?512-n%448-1:448-n-1;const r=new Array((n-7)/8),i=new Array(8);for(let l=0,c=r.length;l<c;l++)r[l]=0;for(let l=0,c=i.length;l<c;l++)i[l]=0;t=t.toString(2);for(let l=7;l>=0;l--)if(t.length>8){const c=t.length-8;i[l]=parseInt(t.substr(c),2),t=t.substr(0,c)}else t.length>0&&(i[l]=parseInt(t,2),t="");const s=new Uint8Array([...e,128,...r,...i]),u=new DataView(s.buffer,0),f=s.length/64,o=new Uint32Array([1937774191,1226093241,388252375,3666478592,2842636476,372324522,3817729613,2969243214]);for(let l=0;l<f;l++){b.fill(0),Q.fill(0);const c=16*l;for(let d=0;d<16;d++)b[d]=u.getUint32((c+d)*4,!1);for(let d=16;d<68;d++)b[d]=Lt(b[d-16]^b[d-9]^v(b[d-3],15))^v(b[d-13],7)^b[d-6];for(let d=0;d<64;d++)Q[d]=b[d]^b[d+4];const a=2043430169,y=2055708042;let g=o[0],p=o[1],m=o[2],q=o[3],B=o[4],P=o[5],S=o[6],k=o[7],j,$,_,tt,et;for(let d=0;d<64;d++)et=d>=0&&d<=15?a:y,j=v(v(g,12)+B+v(et,d),7),$=j^v(g,12),_=(d>=0&&d<=15?g^p^m:g&p|g&m|p&m)+q+$+Q[d],tt=(d>=0&&d<=15?B^P^S:B&P|~B&S)+k+j+b[d],q=m,m=v(p,9),p=g,g=_,k=S,S=v(P,19),P=B,B=jt(tt);o[0]^=g,o[1]^=p,o[2]^=m,o[3]^=q,o[4]^=B,o[5]^=P,o[6]^=S,o[7]^=k}const F=[];for(let l=0,c=o.length;l<c;l++){const a=o[l];F.push((a&4278190080)>>>24,(a&16711680)>>>16,(a&65280)>>>8,a&255)}return F}const X=64,at=new Uint8Array(X),gt=new Uint8Array(X);for(let e=0;e<X;e++)at[e]=54,gt[e]=92;function Xt(e,t){for(t.length>X&&(t=Y(t));t.length<X;)t.push(0);const n=ht(t,at),r=ht(t,gt),i=Y([...n,...e]);return Y([...r,...i])}var ft={sm3:Y,hmac:Xt};const{BigInteger:w}=Z,{encodeDer:Zt,decodeDer:Yt}=bt,h=kt,D=ft.sm3,{G:K,curve:dt,n:O}=h.generateEcparam(),Ft=0;function Vt(e,t,n=1){e=typeof e=="string"?h.hexToArray(h.utf8ToHex(e)):Array.prototype.slice.call(e),t=h.getGlobalCurve().decodePointHex(t);const r=h.generateKeyPairHex(),i=new w(r.privateKey,16);let s=r.publicKey;s.length>128&&(s=s.substr(s.length-128));const u=t.multiply(i),f=h.hexToArray(h.leftPad(u.getX().toBigInteger().toRadix(16),64)),o=h.hexToArray(h.leftPad(u.getY().toBigInteger().toRadix(16),64)),F=h.arrayToHex(D([].concat(f,e,o)));let l=1,c=0,a=[];const y=[].concat(f,o),g=()=>{a=D([...y,l>>24&255,l>>16&255,l>>8&255,l&255]),l++,c=0};g();for(let m=0,q=e.length;m<q;m++)c===a.length&&g(),e[m]^=a[c++]&255;const p=h.arrayToHex(e);return n===Ft?s+p+F:s+F+p}function Gt(e,t,n=1,{output:r="string"}={}){t=new w(t,16);let i=e.substr(128,64),s=e.substr(192);n===Ft&&(i=e.substr(e.length-64),s=e.substr(128,e.length-128-64));const u=h.hexToArray(s),f=h.getGlobalCurve().decodePointHex("04"+e.substr(0,128)).multiply(t),o=h.hexToArray(h.leftPad(f.getX().toBigInteger().toRadix(16),64)),F=h.hexToArray(h.leftPad(f.getY().toBigInteger().toRadix(16),64));let l=1,c=0,a=[];const y=[].concat(o,F),g=()=>{a=D([...y,l>>24&255,l>>16&255,l>>8&255,l&255]),l++,c=0};g();for(let p=0,m=u.length;p<m;p++)c===a.length&&g(),u[p]^=a[c++]&255;return h.arrayToHex(D([].concat(o,u,F)))===i.toLowerCase()?r==="array"?u:h.arrayToUtf8(u):r==="array"?[]:""}function Nt(e,t,{pointPool:n,der:r,hash:i,publicKey:s,userId:u}={}){let f=typeof e=="string"?h.utf8ToHex(e):h.arrayToHex(e);i&&(s=s||pt(t),f=yt(f,s,u));const o=new w(t,16),F=new w(f,16);let l=null,c=null,a=null;do{do{let y;n&&n.length?y=n.pop():y=mt(),l=y.k,c=F.add(y.x1).mod(O)}while(c.equals(w.ZERO)||c.add(l).equals(O));a=o.add(w.ONE).modInverse(O).multiply(l.subtract(c.multiply(o))).mod(O)}while(a.equals(w.ZERO));return r?Zt(c,a):h.leftPad(c.toString(16),64)+h.leftPad(a.toString(16),64)}function Mt(e,t,n,{der:r,hash:i,userId:s}={}){let u=typeof e=="string"?h.utf8ToHex(e):h.arrayToHex(e);i&&(u=yt(u,n,s));let f,o;if(r){const g=Yt(t);f=g.r,o=g.s}else f=new w(t.substring(0,64),16),o=new w(t.substring(64),16);const F=dt.decodePointHex(n),l=new w(u,16),c=f.add(o).mod(O);if(c.equals(w.ZERO))return!1;const a=K.multiply(o).add(F.multiply(c)),y=l.add(a.getX().toBigInteger()).mod(O);return f.equals(y)}function yt(e,t,n="1234567812345678"){n=h.utf8ToHex(n);const r=h.leftPad(K.curve.a.toBigInteger().toRadix(16),64),i=h.leftPad(K.curve.b.toBigInteger().toRadix(16),64),s=h.leftPad(K.getX().toBigInteger().toRadix(16),64),u=h.leftPad(K.getY().toBigInteger().toRadix(16),64);let f,o;if(t.length===128)f=t.substr(0,64),o=t.substr(64,64);else{const a=K.curve.decodePointHex(t);f=h.leftPad(a.getX().toBigInteger().toRadix(16),64),o=h.leftPad(a.getY().toBigInteger().toRadix(16),64)}const F=h.hexToArray(n+r+i+s+u+f+o),l=n.length*4;F.unshift(l&255),F.unshift(l>>8&255);const c=D(F);return h.arrayToHex(D(c.concat(h.hexToArray(e))))}function pt(e){const t=K.multiply(new w(e,16)),n=h.leftPad(t.getX().toBigInteger().toString(16),64),r=h.leftPad(t.getY().toBigInteger().toString(16),64);return"04"+n+r}function mt(){const e=h.generateKeyPairHex(),t=dt.decodePointHex(e.publicKey);return e.k=new w(e.privateKey,16),e.x1=t.getX().toBigInteger(),e}var Jt={generateKeyPairHex:h.generateKeyPairHex,compressPublicKeyHex:h.compressPublicKeyHex,comparePublicKeyHex:h.comparePublicKeyHex,doEncrypt:Vt,doDecrypt:Gt,doSignature:Nt,doVerifySignature:Mt,getPublicKeyFromPrivateKey:pt,getPoint:mt,verifyPublicKey:h.verifyPublicKey};const{sm3:Qt,hmac:Wt}=ft;function $t(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e}function xt(e){return e.map(t=>(t=t.toString(16),t.length===1?"0"+t:t)).join("")}function _t(e){const t=[];let n=e.length;n%2!==0&&(e=$t(e,n+1)),n=e.length;for(let r=0;r<n;r+=2)t.push(parseInt(e.substr(r,2),16));return t}function te(e){const t=[];for(let n=0,r=e.length;n<r;n++){const i=e.codePointAt(n);if(i<=127)t.push(i);else if(i<=2047)t.push(192|i>>>6),t.push(128|i&63);else if(i<=55295||i>=57344&&i<=65535)t.push(224|i>>>12),t.push(128|i>>>6&63),t.push(128|i&63);else if(i>=65536&&i<=1114111)n++,t.push(240|i>>>18&28),t.push(128|i>>>12&63),t.push(128|i>>>6&63),t.push(128|i&63);else throw t.push(i),new Error("input is not supported")}return t}var ee=function(e,t){if(e=typeof e=="string"?te(e):Array.prototype.slice.call(e),t){if((t.mode||"hmac")!=="hmac")throw new Error("invalid mode");let n=t.key;if(!n)throw new Error("invalid key");return n=typeof n=="string"?_t(n):Array.prototype.slice.call(n),xt(Wt(e,n))}return xt(Qt(e))};const E=0,ne=32,R=16,V=[214,144,233,254,204,225,61,183,22,182,20,194,40,251,44,5,43,103,154,118,42,190,4,195,170,68,19,38,73,134,6,153,156,66,80,244,145,239,152,122,51,84,11,67,237,207,172,98,228,179,28,169,201,8,232,149,128,223,148,250,117,143,63,166,71,7,167,252,243,115,23,186,131,89,60,25,230,133,79,168,104,107,129,178,113,100,218,139,248,235,15,75,112,86,157,53,30,36,14,94,99,88,209,162,37,34,124,59,1,33,120,135,212,0,70,87,159,211,39,82,76,54,2,231,160,196,200,158,234,191,138,210,64,199,56,181,163,247,242,206,249,97,21,161,224,174,93,164,155,52,26,85,173,147,50,48,245,140,177,227,29,246,226,46,130,102,202,96,192,41,35,171,13,83,78,111,213,219,55,69,222,253,142,47,3,255,106,114,109,108,91,81,141,27,175,146,187,221,188,127,17,217,92,65,31,16,90,216,10,193,49,136,165,205,123,189,45,116,208,18,184,229,180,176,137,105,151,74,12,150,119,126,101,185,241,9,197,110,198,132,24,240,125,236,58,220,77,32,121,238,95,62,215,203,57,72],G=[462357,472066609,943670861,1415275113,1886879365,2358483617,2830087869,3301692121,3773296373,4228057617,404694573,876298825,1347903077,1819507329,2291111581,2762715833,3234320085,3705924337,4177462797,337322537,808926789,1280531041,1752135293,2223739545,2695343797,3166948049,3638552301,4110090761,269950501,741554753,1213159005,1684763257];function W(e){const t=[];for(let n=0,r=e.length;n<r;n+=2)t.push(parseInt(e.substr(n,2),16));return t}function re(e){return e.map(t=>(t=t.toString(16),t.length===1?"0"+t:t)).join("")}function ie(e){const t=[];for(let n=0,r=e.length;n<r;n++){const i=e.codePointAt(n);if(i<=127)t.push(i);else if(i<=2047)t.push(192|i>>>6),t.push(128|i&63);else if(i<=55295||i>=57344&&i<=65535)t.push(224|i>>>12),t.push(128|i>>>6&63),t.push(128|i&63);else if(i>=65536&&i<=1114111)n++,t.push(240|i>>>18&28),t.push(128|i>>>12&63),t.push(128|i>>>6&63),t.push(128|i&63);else throw t.push(i),new Error("input is not supported")}return t}function se(e){const t=[];for(let n=0,r=e.length;n<r;n++)e[n]>=240&&e[n]<=247?(t.push(String.fromCodePoint(((e[n]&7)<<18)+((e[n+1]&63)<<12)+((e[n+2]&63)<<6)+(e[n+3]&63))),n+=3):e[n]>=224&&e[n]<=239?(t.push(String.fromCodePoint(((e[n]&15)<<12)+((e[n+1]&63)<<6)+(e[n+2]&63))),n+=2):e[n]>=192&&e[n]<=223?(t.push(String.fromCodePoint(((e[n]&31)<<6)+(e[n+1]&63))),n++):t.push(String.fromCodePoint(e[n]));return t.join("")}function U(e,t){const n=t&31;return e<<n|e>>>32-n}function A(e){return(V[e>>>24&255]&255)<<24|(V[e>>>16&255]&255)<<16|(V[e>>>8&255]&255)<<8|V[e&255]&255}function N(e){return e^U(e,2)^U(e,10)^U(e,18)^U(e,24)}function M(e){return e^U(e,13)^U(e,23)}function oe(e,t,n){const r=new Array(4),i=new Array(4);for(let s=0;s<4;s++)i[0]=e[4*s]&255,i[1]=e[4*s+1]&255,i[2]=e[4*s+2]&255,i[3]=e[4*s+3]&255,r[s]=i[0]<<24|i[1]<<16|i[2]<<8|i[3];for(let s=0,u;s<32;s+=4)u=r[1]^r[2]^r[3]^n[s+0],r[0]^=N(A(u)),u=r[2]^r[3]^r[0]^n[s+1],r[1]^=N(A(u)),u=r[3]^r[0]^r[1]^n[s+2],r[2]^=N(A(u)),u=r[0]^r[1]^r[2]^n[s+3],r[3]^=N(A(u));for(let s=0;s<16;s+=4)t[s]=r[3-s/4]>>>24&255,t[s+1]=r[3-s/4]>>>16&255,t[s+2]=r[3-s/4]>>>8&255,t[s+3]=r[3-s/4]&255}function ue(e,t,n){const r=new Array(4),i=new Array(4);for(let s=0;s<4;s++)i[0]=e[0+4*s]&255,i[1]=e[1+4*s]&255,i[2]=e[2+4*s]&255,i[3]=e[3+4*s]&255,r[s]=i[0]<<24|i[1]<<16|i[2]<<8|i[3];r[0]^=2746333894,r[1]^=1453994832,r[2]^=1736282519,r[3]^=2993693404;for(let s=0,u;s<32;s+=4)u=r[1]^r[2]^r[3]^G[s+0],t[s+0]=r[0]^=M(A(u)),u=r[2]^r[3]^r[0]^G[s+1],t[s+1]=r[1]^=M(A(u)),u=r[3]^r[0]^r[1]^G[s+2],t[s+2]=r[2]^=M(A(u)),u=r[0]^r[1]^r[2]^G[s+3],t[s+3]=r[3]^=M(A(u));if(n===E)for(let s=0,u;s<16;s++)u=t[s],t[s]=t[31-s],t[31-s]=u}function wt(e,t,n,{padding:r="pkcs#7",mode:i,iv:s=[],output:u="string"}={}){if(i==="cbc"&&(typeof s=="string"&&(s=W(s)),s.length!==128/8))throw new Error("iv is invalid");if(typeof t=="string"&&(t=W(t)),t.length!==128/8)throw new Error("key is invalid");if(typeof e=="string"?n!==E?e=ie(e):e=W(e):e=[...e],(r==="pkcs#5"||r==="pkcs#7")&&n!==E){const a=R-e.length%R;for(let y=0;y<a;y++)e.push(a)}const f=new Array(ne);ue(t,f,n);const o=[];let F=s,l=e.length,c=0;for(;l>=R;){const a=e.slice(c,c+16),y=new Array(16);if(i==="cbc")for(let g=0;g<R;g++)n!==E&&(a[g]^=F[g]);oe(a,y,f);for(let g=0;g<R;g++)i==="cbc"&&n===E&&(y[g]^=F[g]),o[c+g]=y[g];i==="cbc"&&(n!==E?F=y:F=a),l-=R,c+=R}if((r==="pkcs#5"||r==="pkcs#7")&&n===E){const a=o.length,y=o[a-1];for(let g=1;g<=y;g++)if(o[a-g]!==y)throw new Error("padding is invalid");o.splice(a-y,y)}return u!=="array"?n!==E?re(o):se(o):o}var le={encrypt(e,t,n){return wt(e,t,1,n)},decrypt(e,t,n){return wt(e,t,0,n)}},ce={sm2:Jt,sm3:ee,sm4:le};export{ce as s};
